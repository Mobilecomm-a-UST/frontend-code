"use strict";(self.webpackChunkmobilecomm=self.webpackChunkmobilecomm||[]).push([[7494],{88845:(e,t,l)=>{l.d(t,{Z:()=>c});var a=l(72791),n=l(5574),o=l(39157),s=l(64554),i=l(63571),r=l(80184);const c=()=>{const[e,t]=(0,a.useState)(!1);return{loading:(0,a.useMemo)((()=>(0,r.jsx)(n.Z,{open:e,BackdropProps:{style:{backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(3px)"}},keepMounted:!0,children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(s.Z,{style:{padding:20,display:"flex",justifyContent:"center"}}),(0,r.jsx)(s.Z,{style:{textAlign:"center"},children:(0,r.jsx)(i.Z,{pulse:!0,style:{fontSize:"100px",color:"#232455"}})}),(0,r.jsx)(s.Z,{style:{margin:"10px 0px 10px 0px",fontWeight:"bolder"},children:"DATA UNDER PROCESSING..."})]})})),[e]),action:e=>{t(e)}}}},30204:(e,t,l)=>{l.d(t,{u:()=>i});var a=l(72791),n=l(31243),o=l(44997),s=l(61982);const i=e=>{const[t,l]=(0,a.useState)(!1),[i,r]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[p,u]=(0,a.useState)(null),[h,m]=(0,a.useState)(0),x=()=>{p&&p.cancel()};return(0,a.useEffect)((()=>x),[]),{isLoading:t,error:i,response:c,makePostRequest:async(t,a)=>{l(!0),r(null),d(null);const c=n.Z.CancelToken.source();u(c);try{const l=await n.Z.post("".concat(o.hN,"/").concat(t),a,{...e,cancelToken:c.token,headers:{Authorization:"token ".concat((0,s.b)("tokenKey"))}});return d(l),await l.data}catch(i){return n.Z.isCancel(i)?(console.log("Request canceled"),!1):(r(i),console.log("error",i),!1)}finally{l(!1)}},cancelRequest:x}}},17494:(e,t,l)=>{l.r(t),l.d(t,{default:()=>D});var a=l(72791),n=l(64554),o=l(93006),s=l(97639),i=l(90977),r=l(73518),c=l(39281),d=l(4841),p=l(55931),u=l(30204),h=l(88845),m=l(12998),x=l(61982),g=l(77196),y=l(50168),b=l(82626),j=l(45363),k=l(49900),_=l(17563),f=l(13034),w=l(44997),C=l(3638),S=(l(64197),l(78687)),v=l(57689),Z=l(25415),F=l(80184);const R=e=>{let{label:t,options:l,selectedValues:a,setSelectedValues:n}=e;const o=l.length>0&&a.length===l.length;return(0,F.jsxs)(j.Z,{sx:{minWidth:120,maxWidth:120},size:"small",children:[(0,F.jsx)(y.Z,{id:"".concat(t,"-label"),children:t}),(0,F.jsxs)(_.Z,{labelId:"".concat(t,"-label"),multiple:!0,value:a,onChange:e=>{const{value:t}=e.target,o="string"===typeof t?t.split(","):t;o.includes("ALL")?a.length===l.length?n([]):n(l):n(o)},input:(0,F.jsx)(g.Z,{label:t}),renderValue:e=>e.join(", "),children:[(0,F.jsxs)(b.Z,{value:"ALL",children:[(0,F.jsx)(f.Z,{checked:o,indeterminate:a.length>0&&a.length<l.length}),(0,F.jsx)(k.Z,{primary:"Select All"})]}),l.map((e=>(0,F.jsxs)(b.Z,{value:e,children:[(0,F.jsx)(f.Z,{checked:a.includes(e)}),(0,F.jsx)(k.Z,{primary:e})]},e)))]})]})},I=()=>{const e=(0,m.y)(),t=(0,S.I0)(),l=(0,v.s0)(),[g,k]=(0,a.useState)(!0),{makePostRequest:f}=(0,u.u)(),{loading:I,action:W}=(0,h.Z)(),A=(0,x.b)("userID"),[M,T]=(0,a.useState)([]),[N,O]=(0,a.useState)([]),[V,q]=(0,a.useState)([]),[B,z]=(0,a.useState)(""),[L,D]=(0,a.useState)([]),[E,P]=(0,a.useState)([]),[J,U]=(0,a.useState)([]),[G,Y]=(0,a.useState)([]),[K,H]=(0,a.useState)([]),[Q,X]=(0,a.useState)([]),[$,ee]=(0,a.useState)([]),[te,le]=(0,a.useState)([]),[ae,ne]=(0,a.useState)(""),[oe,se]=(0,a.useState)("Cumulative"),[ie,re]=(0,a.useState)([]),[ce,de]=(0,a.useState)(""),{afterToday:pe,combine:ue}=C.default,he=e=>{if(!e)return"";const t=new Date(e);if(isNaN(t))return"Invalid Date";const l=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(l,"-").concat(a,"-").concat(n)};return(0,a.useEffect)((()=>{(async()=>{W(!0);var e=new FormData;e.append("circle",L),e.append("site_tagging",J),e.append("relocation_method",K),e.append("new_toco_name",$),e.append("from_date",ie[0]||""),e.append("to_date",ie[1]||""),e.append("view",oe),e.append("month",ce.split("-")[1]||""),e.append("year",ce.split("-")[0]||"");const t=await(0,w.qC)("alok_tracker/daily_dashboard_file/",e);console.log("date wise response",JSON.parse(t.data)),t?(W(!1),T(t.dates),O(JSON.parse(t.data)),P(t.unique_data.unique_circle),Y(t.unique_data.unique_site_tagging),X(t.unique_data.unique_relocation_method),le(t.unique_data.unique_new_toco_name),q(t.unique_data.Milestone),ne(t.download_link)):W(!1)})()}),[L,J,K,$,ie,oe,ce]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("style",{children:"th{border:1px solid black;}"}),(0,F.jsx)(p.Z,{direction:"left",in:"true",timeout:700,style:{transformOrigin:"1 1 1"},children:(0,F.jsxs)("div",{style:{margin:20},children:[(0,F.jsxs)(n.Z,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",alignContent:"center"},children:[(0,F.jsx)(n.Z,{style:{fontSize:22,fontWeight:"bold"},children:"Daily Progress - RFAI to MS1 Waterfall"}),(0,F.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",gap:1},children:[(0,F.jsx)(j.Z,{sx:{minWidth:200},size:"small",children:(0,F.jsx)(C.default,{onChange:e=>(e=>{const t=e.map((e=>he(e)));re(t)})(e),size:"md",format:"dd.MM.yyyy",shouldDisableDate:pe,placeholder:"Select Date Range",color:"black"})}),(0,F.jsx)(j.Z,{sx:{minWidth:100,maxWidth:100},size:"small",children:(0,F.jsx)(o.Z,{variant:"outlined",fullWidth:!0,label:"Month",name:"month",value:ce,onChange:e=>de(e.target.value),size:"small",type:"month",InputLabelProps:{shrink:!0}})}),(0,F.jsxs)(j.Z,{sx:{minWidth:100,maxWidth:100},size:"small",children:[(0,F.jsx)(y.Z,{id:"demo-select-small-label",children:"View"}),(0,F.jsxs)(_.Z,{labelId:"demo-select-small-label",id:"demo-select-small",value:oe,label:"View",onChange:e=>{se(e.target.value)},children:[(0,F.jsx)(b.Z,{value:"Cumulative",children:"Cumulative"}),(0,F.jsx)(b.Z,{value:"Non-cumulative",children:"Non-cumulative"})]})]}),(0,F.jsx)(R,{label:"Circle",options:E,selectedValues:L,setSelectedValues:D}),(0,F.jsx)(R,{label:"Site Tagging",options:G,selectedValues:J,setSelectedValues:U}),(0,F.jsx)(R,{label:"Current Status",options:Q,selectedValues:K,setSelectedValues:H}),(0,F.jsx)(R,{label:"TOCO",options:te,selectedValues:$,setSelectedValues:ee}),(0,F.jsx)(s.Z,{title:"Download Daily-RFAI to MS1 Waterfall",children:(0,F.jsx)(i.Z,{component:"a",onClick:async()=>{const e=new Z.Workbook,t=e.addWorksheet("Daily Progress"),l=[{header:"Milestone Track/Site Count",key:"milestone",width:30},{header:"CF",key:"cf",width:10},{header:"AOP",key:"AOP",width:10}];M.forEach(((e,t)=>{l.push({header:e,key:"date_".concat(t+1),width:15})})),l.push({header:"Gap",key:"gap",width:10}),t.columns=l,N.forEach(((e,l)=>{var a,n,o;const s={milestone:e["Milestone Track/Site Count"],cf:null!==(a=e.CF)&&void 0!==a?a:"",AOP:null!==(n=e.AOP)&&void 0!==n?n:""};M.forEach(((t,l)=>{var a;s["date_".concat(l+1)]=null!==(a=e["date_".concat(l+1)])&&void 0!==a?a:""})),s.gap=null!==(o=e.Gap)&&void 0!==o?o:"",t.addRow(s)})),t.getRow(1).eachCell((e=>{e.font={bold:!0,color:{argb:"FFFFFF"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"223354"}},e.alignment={horizontal:"center",vertical:"middle"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.eachRow(((e,t)=>{1!==t&&e.eachCell((e=>{e.alignment={horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}))}));const a=await e.xlsx.writeBuffer(),n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download="Daily_Progress-RFAI_to_MS1_Waterfall.xlsx",s.click(),URL.revokeObjectURL(o)},download:!0,children:(0,F.jsx)(r.Z,{fontSize:"large",color:"primary"})})})]})]}),(0,F.jsx)(n.Z,{sx:{marginTop:0},children:(0,F.jsx)(c.Z,{sx:{maxHeight:600,boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px"},component:d.Z,children:(0,F.jsxs)("table",{style:{width:"100%",border:"1px solid black",borderCollapse:"collapse",overflow:"auto"},children:[(0,F.jsx)("thead",{style:{position:"sticky",top:0,zIndex:1},children:(0,F.jsxs)("tr",{style:{fontSize:15,backgroundColor:"#223354",color:"white",border:"1px solid white"},children:[(0,F.jsx)("th",{style:{padding:"5px 10px",whiteSpace:"nowrap",position:"sticky",left:0,top:0,backgroundColor:"#006e74"},children:"Milestone Track/Site Count"}),(0,F.jsx)("th",{style:{padding:"5px 15px",whiteSpace:"nowrap",backgroundColor:"#006e74"},children:"AOP"}),ce&&(0,F.jsx)("th",{style:{padding:"5px 15px",whiteSpace:"nowrap",backgroundColor:"#006e74"},children:"CF"}),null===M||void 0===M?void 0:M.map(((e,t)=>(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",backgroundColor:"#CBCBCB",color:"black"},children:e},t))),(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",backgroundColor:"#ff6060"},children:"Gap"})]})}),(0,F.jsx)("tbody",{children:null===N||void 0===N?void 0:N.map(((a,n)=>(0,F.jsxs)("tr",{className:e.hoverRT,style:{textAlign:"center",fontWeigth:700},children:[(0,F.jsx)("th",{style:{position:"sticky",left:0,top:0,backgroundColor:"#CBCBCB",color:"black"},children:a["Milestone Track/Site Count"]}),(0,F.jsx)("th",{style:{backgroundColor:"#CBCBCB",color:"black"},children:a.AOP}),ce&&(0,F.jsx)("th",{style:{backgroundColor:"#CBCBCB",color:"black"},children:a.CF}),null===M||void 0===M?void 0:M.map(((n,o)=>(0,F.jsx)("th",{className:e.hoverRT,style:{cursor:"pointer"},onClick:()=>(async e=>{W(!0);var a=new FormData;a.append("userId",A),a.append("circle",L),a.append("day_type","daily"),a.append("milestone",e.milestone),a.append("col_name",e.col_name),a.append("site_tagging",J),a.append("current_status",K),a.append("toco_name",$),a.append("view",oe);const n=await f("alok_tracker/hyperlink_frontend_editing/",a);if(n){console.log("response",JSON.parse(n.data)),W(!1);const a=JSON.parse(n.data);t({type:"RELOCATION_FINAL_TRACKER",payload:{temp:a}}),l("/tools/relocation_tracking/rfai_to_ms1_waterfall/".concat(e.milestone))}else W(!1)})({date_value:a["date_".concat(o+1)],col_name:n,milestone:a["Milestone Track/Site Count"]}),children:isNaN(parseInt(a["date_".concat(o+1)]))?"-":parseInt(a["date_".concat(o+1)])},o))),(0,F.jsx)("th",{style:{cursor:"pointer"},title:"Click to Download Excel",className:e.hoverRT,onClick:()=>(async(e,t,l)=>{if(0==l||"-"===l)alert("Gap value is zero, file not available for download");else if(t&&e&&l){W(!0);var a=new FormData;a.append("circle",L),a.append("site_tagging",J),a.append("relocation_method",K),a.append("new_toco_name",$),a.append("milestone1",e),a.append("milestone2",t),a.append("last_date",(e=>{const[t,l,a]=e.split("-"),n={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"}[l],o="20".concat(a);return"".concat(o,"-").concat(n,"-").concat(t)})(M.at(-1))),a.append("gap",l),a.append("userId",A);try{const e=await(0,w.qC)("alok_tracker/gap_view/",a);if(console.log("gap response",e),null!==e&&void 0!==e&&e.download_link){const t=document.createElement("a");t.href=e.download_link,t.setAttribute("download",""),document.body.appendChild(t),t.click(),document.body.removeChild(t)}}catch(n){console.error("Error downloading file:",n)}finally{W(!1)}}})(V[n-1],V[n],a.Gap),children:isNaN(parseInt(a.Gap))?"-":parseInt(a.Gap)})]},n)))})]})})})]})}),I]})},W=a.memo(I),A=e=>{let{label:t,options:l,selectedValues:a,setSelectedValues:n}=e;const o=l.length>0&&a.length===l.length;return(0,F.jsxs)(j.Z,{sx:{minWidth:120,maxWidth:120},size:"small",children:[(0,F.jsx)(y.Z,{id:"".concat(t,"-label"),children:t}),(0,F.jsxs)(_.Z,{labelId:"".concat(t,"-label"),multiple:!0,value:a,onChange:e=>{const{value:t}=e.target,o="string"===typeof t?t.split(","):t;o.includes("ALL")?a.length===l.length?n([]):n(l):n(o)},input:(0,F.jsx)(g.Z,{label:t}),renderValue:e=>e.join(", "),children:[(0,F.jsxs)(b.Z,{value:"ALL",children:[(0,F.jsx)(f.Z,{checked:o,indeterminate:a.length>0&&a.length<l.length}),(0,F.jsx)(k.Z,{primary:"Select All"})]}),l.map((e=>(0,F.jsxs)(b.Z,{value:e,children:[(0,F.jsx)(f.Z,{checked:a.includes(e)}),(0,F.jsx)(k.Z,{primary:e})]},e)))]})]})},M=()=>{const e=(0,m.y)(),t=(0,S.I0)(),l=(0,v.s0)(),o=(0,x.b)("userID"),[g,k]=(0,a.useState)(!1),{makePostRequest:f}=(0,u.u)(),{loading:C,action:R}=(0,h.Z)(),[I,W]=(0,a.useState)([]),[M,T]=(0,a.useState)([]),[N,O]=(0,a.useState)([]),[V,q]=(0,a.useState)([]),[B,z]=(0,a.useState)([]),[L,D]=(0,a.useState)([]),[E,P]=(0,a.useState)([]),[J,U]=(0,a.useState)([]),[G,Y]=(0,a.useState)([]),[K,H]=(0,a.useState)([]),[Q,X]=(0,a.useState)([]),[$,ee]=(0,a.useState)(""),[te,le]=(0,a.useState)("Cumulative");return(0,a.useEffect)((()=>{(async()=>{R(!0);var e=new FormData;e.append("circle",V),e.append("site_tagging",L),e.append("relocation_method",J),e.append("new_toco_name",K),e.append("view",te);const t=await(0,w.qC)("alok_tracker/weekly_monthly_dashboard_file/",e);console.log("month wise response",t),t?(R(!1),T(t.unique_data.month_columns),O(JSON.parse(t.months_data)),z(t.unique_data.unique_circle),P(t.unique_data.unique_site_tagging),Y(t.unique_data.unique_relocation_method),X(t.unique_data.unique_new_toco_name),ee(t.download_link)):R(!1)})()}),[V,L,J,K,te]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("style",{children:"th{border:1px solid black;}"}),(0,F.jsx)(p.Z,{direction:"left",in:"true",timeout:700,style:{transformOrigin:"1 1 1"},children:(0,F.jsxs)("div",{style:{margin:20},children:[(0,F.jsxs)(n.Z,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",alignContent:"center"},children:[(0,F.jsx)(n.Z,{style:{fontSize:22,fontWeight:"bold"},children:"Yearly Progress - RFAI to MS1 Waterfall"}),(0,F.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",gap:1},children:[(0,F.jsxs)(j.Z,{sx:{minWidth:100,maxWidth:100},size:"small",children:[(0,F.jsx)(y.Z,{id:"demo-select-small-label",children:"View"}),(0,F.jsxs)(_.Z,{labelId:"demo-select-small-label",id:"demo-select-small",value:te,label:"View",onChange:e=>{le(e.target.value)},children:[(0,F.jsx)(b.Z,{value:"Cumulative",children:"Cumulative"}),(0,F.jsx)(b.Z,{value:"Non-cumulative",children:"Non-cumulative"})]})]}),(0,F.jsx)(A,{label:"Circle",options:B,selectedValues:V,setSelectedValues:q}),(0,F.jsx)(A,{label:"Site Tagging",options:E,selectedValues:L,setSelectedValues:D}),(0,F.jsx)(A,{label:"Current Status",options:G,selectedValues:J,setSelectedValues:U}),(0,F.jsx)(A,{label:"TOCO",options:Q,selectedValues:K,setSelectedValues:H}),(0,F.jsx)(s.Z,{title:"Download Yearly-RFAI to MS1 Waterfall",children:(0,F.jsx)(i.Z,{component:"a",onClick:async()=>{const e=new Z.Workbook,t=e.addWorksheet("Yearly Progress",{properties:{tabColor:{argb:"223354"}}}),l=[{header:"Milestone Track/Site Count",key:"milestone",width:30},{header:"CF",key:"CF",width:10}];M.forEach(((e,t)=>{l.push({header:e,key:"Month_".concat(t+1),width:15})})),t.columns=l,N.forEach((e=>{var l;const a={milestone:e["Milestone Track/Site Count"],CF:null!==(l=e.CF)&&void 0!==l?l:""};M.forEach(((t,l)=>{var n;a["Month_".concat(l+1)]=null!==(n=Number(e["Month-".concat(l+1)]))&&void 0!==n?n:""})),t.addRow(a)})),t.eachRow(((e,t)=>{e.eachCell((e=>{e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},1===t&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"223354"}},e.font={color:{argb:"FFFFFF"},bold:!0,size:12})}))}));const a=await e.xlsx.writeBuffer(),n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheet.sheet"}),o=window.URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download="Yearly_Progress_RFAI_to_MS1_Waterfall.xlsx",s.click(),window.URL.revokeObjectURL(o)},download:!0,children:(0,F.jsx)(r.Z,{fontSize:"large",color:"primary"})})})]})]}),(0,F.jsx)(n.Z,{sx:{marginTop:0},children:(0,F.jsx)(c.Z,{sx:{maxHeight:600,boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px"},component:d.Z,children:(0,F.jsxs)("table",{style:{width:"100%",border:"1px solid black",borderCollapse:"collapse",overflow:"auto"},children:[(0,F.jsx)("thead",{style:{position:"sticky",top:0,zIndex:1},children:(0,F.jsxs)("tr",{style:{fontSize:15,backgroundColor:"#223354",color:"white",border:"1px solid white"},children:[(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",position:"sticky",left:0,top:0,backgroundColor:"#006e74"},children:"Milestone Track/Site Count"}),(0,F.jsx)("th",{style:{padding:"5px 15px",whiteSpace:"nowrap",position:"sticky",left:218,top:0,backgroundColor:"#006e74"},children:"CF"}),null===M||void 0===M?void 0:M.map(((e,t)=>(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",backgroundColor:"#CBCBCB",color:"black"},children:e},t)))]})}),(0,F.jsx)("tbody",{children:null===N||void 0===N?void 0:N.map(((a,n)=>(0,F.jsxs)("tr",{className:e.hoverRT,style:{textAlign:"center",fontWeigth:700},children:[(0,F.jsx)("th",{style:{position:"sticky",left:0,top:0,backgroundColor:"#CBCBCB",color:"black"},children:a["Milestone Track/Site Count"]}),(0,F.jsx)("th",{style:{position:"sticky",left:218,top:0,backgroundColor:"#CBCBCB",color:"black"},children:a.CF}),null===M||void 0===M?void 0:M.map(((n,s)=>(0,F.jsx)("th",{className:e.hoverRT,style:{cursor:"pointer"},onClick:()=>(async e=>{R(!0);var a=new FormData;a.append("userId",o),a.append("circle",V),a.append("day_type","monthly    "),a.append("milestone",e.milestone),a.append("col_name",e.col_name),a.append("site_tagging",L),a.append("current_status",J),a.append("toco_name",K),a.append("view",te);const n=await f("alok_tracker/hyperlink_frontend_editing/",a);if(n){console.log("response",JSON.parse(n.data)),R(!1);const a=JSON.parse(n.data);t({type:"RELOCATION_FINAL_TRACKER",payload:{temp:a}}),l("/tools/relocation_tracking/rfai_to_ms1_waterfall/".concat(e.milestone))}else R(!1)})({col_name:n,milestone:a["Milestone Track/Site Count"]}),children:a["Month-".concat(s+1)]},s)))]},n)))})]})})})]})}),C]})},T=a.memo(M),N=e=>{let{label:t,options:l,selectedValues:a,setSelectedValues:n}=e;const o=l.length>0&&a.length===l.length;return(0,F.jsxs)(j.Z,{sx:{minWidth:120,maxWidth:120},size:"small",children:[(0,F.jsx)(y.Z,{id:"".concat(t,"-label"),children:t}),(0,F.jsxs)(_.Z,{labelId:"".concat(t,"-label"),multiple:!0,value:a,onChange:e=>{const{value:t}=e.target,o="string"===typeof t?t.split(","):t;o.includes("ALL")?a.length===l.length?n([]):n(l):n(o)},input:(0,F.jsx)(g.Z,{label:t}),renderValue:e=>e.join(", "),children:[(0,F.jsxs)(b.Z,{value:"ALL",children:[(0,F.jsx)(f.Z,{checked:o,indeterminate:a.length>0&&a.length<l.length}),(0,F.jsx)(k.Z,{primary:"Select All"})]}),l.map((e=>(0,F.jsxs)(b.Z,{value:e,children:[(0,F.jsx)(f.Z,{checked:a.includes(e)}),(0,F.jsx)(k.Z,{primary:e})]},e)))]})]})},O=()=>{const e=(0,m.y)(),t=(0,S.I0)(),l=(0,v.s0)(),[g,k]=(0,a.useState)(!1),{makePostRequest:f}=(0,u.u)(),C=(0,x.b)("userID"),{loading:R,action:I}=(0,h.Z)(),[W,A]=(0,a.useState)([]),[M,T]=(0,a.useState)([]),[O,V]=(0,a.useState)([]),[q,B]=(0,a.useState)([]),[z,L]=(0,a.useState)([]),[D,E]=(0,a.useState)([]),[P,J]=(0,a.useState)([]),[U,G]=(0,a.useState)([]),[Y,K]=(0,a.useState)([]),[H,Q]=(0,a.useState)([]),[X,$]=(0,a.useState)([]),[ee,te]=(0,a.useState)(""),[le,ae]=(0,a.useState)(""),[ne,oe]=(0,a.useState)("Cumulative");return(0,a.useEffect)((()=>{(async()=>{I(!0);var e=new FormData;e.append("circle",q),e.append("site_tagging",D),e.append("relocation_method",U),e.append("new_toco_name",H),e.append("month",ee.split("-")[1]||""),e.append("year",ee.split("-")[0]||""),e.append("view",ne);const t=await(0,w.qC)("alok_tracker/weekly_monthly_dashboard_file/",e);console.log("week wise response",JSON.parse(t.week_data),t.unique_data.week_columns),t?(I(!1),T(t.unique_data.week_columns),V(JSON.parse(t.week_data)),L(t.unique_data.unique_circle),J(t.unique_data.unique_site_tagging),K(t.unique_data.unique_relocation_method),$(t.unique_data.unique_new_toco_name),ae(t.download_link)):I(!1)})()}),[q,D,U,H,ee,ne]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("style",{children:"th{border:1px solid black;}"}),(0,F.jsx)(p.Z,{direction:"left",in:"true",timeout:700,style:{transformOrigin:"1 1 1"},children:(0,F.jsxs)("div",{style:{margin:20},children:[(0,F.jsxs)(n.Z,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",alignContent:"center"},children:[(0,F.jsx)(n.Z,{style:{fontSize:22,fontWeight:"bold"},children:"Monthly Progress - RFAI to MS1 Waterfall"}),(0,F.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",gap:1},children:[(0,F.jsx)(j.Z,{sx:{minWidth:100,maxWidth:100},size:"small",children:(0,F.jsx)(o.Z,{variant:"outlined",fullWidth:!0,label:"Month",name:"month",value:ee,onChange:e=>{te(e.target.value)},size:"small",type:"month",InputLabelProps:{shrink:!0}})}),(0,F.jsxs)(j.Z,{sx:{minWidth:100,maxWidth:100},size:"small",children:[(0,F.jsx)(y.Z,{id:"demo-select-small-label",children:"View"}),(0,F.jsxs)(_.Z,{labelId:"demo-select-small-label",id:"demo-select-small",value:ne,label:"View",onChange:e=>{oe(e.target.value)},children:[(0,F.jsx)(b.Z,{value:"Cumulative",children:"Cumulative"}),(0,F.jsx)(b.Z,{value:"Non-cumulative",children:"Non-cumulative"})]})]}),(0,F.jsx)(N,{label:"Circle",options:z,selectedValues:q,setSelectedValues:B}),(0,F.jsx)(N,{label:"Site Tagging",options:P,selectedValues:D,setSelectedValues:E}),(0,F.jsx)(N,{label:"Current Status",options:Y,selectedValues:U,setSelectedValues:G}),(0,F.jsx)(N,{label:"TOCO",options:X,selectedValues:H,setSelectedValues:Q}),(0,F.jsx)(s.Z,{title:"Download Monthly-RFAI to MS1",children:(0,F.jsx)(i.Z,{component:"a",onClick:async()=>{const e=new Z.Workbook,t=e.addWorksheet("Monthly Progress",{properties:{tabColor:{argb:"f1948a"}}}),l=M.map(((e,t)=>({header:e,key:"Week".concat(t+1),width:15})));t.columns=[{header:"Milestone Track/Site Count",key:"milestone",width:30},...l],O.forEach((e=>{let l={milestone:e["Milestone Track/Site Count"]};M.forEach(((t,a)=>{l["Week".concat(a+1)]=e["Month_Week-".concat(a+1)]})),t.addRow(l)})),t.eachRow(((e,t)=>{e.eachCell((e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.alignment={vertical:"middle",horizontal:"center"},1===t&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"223354"}},e.font={color:{argb:"FFFFFF"},bold:!0,size:13})}))}));const a=await e.xlsx.writeBuffer(),n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheet.sheet"}),o=window.URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download="Monthly_Progress-RFAI_to_MS1_Waterfall.xlsx",s.click(),window.URL.revokeObjectURL(o)},download:!0,children:(0,F.jsx)(r.Z,{fontSize:"large",color:"primary"})})})]})]}),(0,F.jsx)(n.Z,{sx:{marginTop:0},children:(0,F.jsx)(c.Z,{sx:{maxHeight:600,boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px"},component:d.Z,children:(0,F.jsxs)("table",{style:{width:"100%",border:"1px solid black",borderCollapse:"collapse",overflow:"auto"},children:[(0,F.jsx)("thead",{style:{position:"sticky",top:0,zIndex:1},children:(0,F.jsxs)("tr",{style:{fontSize:15,backgroundColor:"#223354",color:"white",border:"1px solid white"},children:[(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",position:"sticky",left:0,top:0,backgroundColor:"#006e74"},children:"Milestone Track/Site Count"}),null===M||void 0===M?void 0:M.map(((e,t)=>(0,F.jsx)("th",{style:{padding:"5px 5px",whiteSpace:"nowrap",backgroundColor:"#CBCBCB",color:"black"},children:e},t)))]})}),(0,F.jsx)("tbody",{children:null===O||void 0===O?void 0:O.map(((a,n)=>(0,F.jsxs)("tr",{className:e.hoverRT,style:{textAlign:"center",fontWeigth:700},children:[(0,F.jsx)("th",{style:{position:"sticky",left:0,top:0,backgroundColor:"#CBCBCB",color:"black"},children:a["Milestone Track/Site Count"]}),null===M||void 0===M?void 0:M.map(((n,o)=>(0,F.jsx)("th",{className:e.hoverRT,style:{cursor:"pointer"},onClick:()=>(async e=>{I(!0);var a=new FormData;a.append("userId",C),a.append("circle",q),a.append("day_type","weekly"),a.append("milestone",e.milestone),a.append("col_name",e.col_name),a.append("site_tagging",D),a.append("current_status",U),a.append("toco_name",H),a.append("view",ne);const n=await f("alok_tracker/hyperlink_frontend_editing/",a);if(n){console.log("response",JSON.parse(n.data)),I(!1);const a=JSON.parse(n.data);t({type:"RELOCATION_FINAL_TRACKER",payload:{temp:a}}),l("/tools/relocation_tracking/rfai_to_ms1_waterfall/".concat(e.milestone))}else I(!1)})({col_name:n,milestone:a["Milestone Track/Site Count"]}),children:a["Month_Week-".concat(o+1)]},o)))]},n)))})]})})})]})}),R]})},V=a.memo(O);var q=l(93517),B=l(50533),z=l(4567),L=l(5397);const D=()=>{const e=(0,v.s0)();return(0,a.useEffect)((()=>{document.title="".concat(window.location.pathname.slice(1).replaceAll("_"," ").replaceAll("/"," | ").toUpperCase())}),[]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:{margin:5,marginLeft:10},children:(0,F.jsxs)(q.Z,{"aria-label":"breadcrumb",itemsBeforeCollapse:2,maxItems:3,separator:(0,F.jsx)(L.Z,{fontSize:"small"}),children:[(0,F.jsx)(B.Z,{underline:"hover",onClick:()=>{e("/tools")},children:"Tools"}),(0,F.jsx)(B.Z,{underline:"hover",onClick:()=>{e("/tools/relocation_tracking")},children:"Relocation Tracking"}),(0,F.jsx)(z.Z,{color:"text.primary",children:"Waterfall Dashboard"})]})}),(0,F.jsx)(n.Z,{children:(0,F.jsx)(W,{})}),(0,F.jsx)(n.Z,{children:(0,F.jsx)(V,{})}),(0,F.jsx)(n.Z,{children:(0,F.jsx)(T,{})})]})}}}]);
//# sourceMappingURL=7494.8ba1780e.chunk.js.map